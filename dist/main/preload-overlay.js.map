{"version":3,"file":"preload-overlay.js","mappings":"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","sources":["webpack://language-agent/./src/shared/types.ts","webpack://language-agent/external node-commonjs \"electron\"","webpack://language-agent/webpack/bootstrap","webpack://language-agent/./src/main/preload-overlay.ts"],"sourcesContent":["// Shared type definitions for the Language Agent application\n\nexport type TranscriptionState = 'idle' | 'starting' | 'active' | 'stopping';\n\nexport type WhisperModel = 'tiny' | 'base' | 'small';\n\nexport type SupportedLanguage =\n  | 'ja' // Japanese\n  | 'ko' // Korean\n  | 'zh' // Chinese (Mandarin)\n  | 'es' // Spanish\n  | 'fr' // French\n  | 'de' // German\n  | 'en' // English\n  | 'auto'; // Auto-detect\n\nexport type TranscriptionProvider = 'deepgram' | 'gladia' | 'speechmatics';\n\nexport type OverlayMode = 'bubble' | 'subtitle';\n\nexport const OVERLAY_MODE_NAMES: Record<OverlayMode, string> = {\n  bubble: 'Floating Bubble',\n  subtitle: 'Classic Subtitles',\n};\n\nexport type TranslationDisplayMode = 'stacked' | 'original' | 'translation';\n\nexport const TRANSLATION_DISPLAY_MODE_NAMES: Record<TranslationDisplayMode, string> = {\n  stacked: 'Stacked (Both)',\n  original: 'Original Only',\n  translation: 'Translation Only',\n};\n\nexport interface TranscriptionResult {\n  text: string;\n  timestamp: number;\n  confidence: number;\n  language?: string;\n  isFinal?: boolean;      // Whether this is the final transcription for this segment\n  speechFinal?: boolean;  // Whether the speaker has finished this utterance\n  speaker?: number;       // Speaker ID from diarization (0, 1, 2, etc.)\n  translation?: string;   // Translated text (if translation enabled)\n}\n\n// Speaker colors for diarization display\nexport const SPEAKER_COLORS: Record<number, string> = {\n  0: '#60A5FA', // Blue\n  1: '#34D399', // Green\n  2: '#F472B6', // Pink\n  3: '#FBBF24', // Yellow\n  4: '#A78BFA', // Purple\n  5: '#FB923C', // Orange\n};\n\nexport interface SavedTranscript {\n  id: string;\n  title: string;\n  content: string;\n  language: SupportedLanguage;\n  startTime: number;      // Unix timestamp when session started\n  endTime: number;        // Unix timestamp when session ended\n  duration: number;       // Duration in seconds\n  wordCount: number;\n  createdAt: number;      // Unix timestamp\n}\n\nexport interface OverlayPosition {\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n}\n\nexport interface OverlayStyle {\n  position: 'bottom' | 'top' | 'custom';\n  customPosition?: { x: number; y: number };\n  fontFamily: string;\n  fontSize: number;\n  fontWeight: number;\n  textColor: string;\n  backgroundColor: string;\n  backgroundOpacity: number;\n  textShadow: boolean;\n  textOutline: boolean;\n  maxLines: number;\n  displayDuration: number; // in seconds\n}\n\nexport interface BubbleState {\n  x: number;       // -1 means center\n  y: number;       // -1 means center\n  width: number;\n  height: number;\n  collapsed: boolean;\n}\n\nexport interface AppSettings {\n  // Provider selection\n  transcriptionProvider: TranscriptionProvider;\n\n  // API settings\n  deepgramApiKey: string;\n  gladiaApiKey: string;\n  speechmaticsApiKey: string;\n\n  // Model settings\n  whisperModel: WhisperModel;\n  language: SupportedLanguage;\n\n  // Performance settings\n  gpuAcceleration: boolean;\n  chunkSize: number; // in seconds (1-3)\n\n  // Transcription features\n  diarization: boolean; // Enable speaker diarization\n\n  // Translation settings (Gladia only)\n  translationEnabled: boolean;\n  translationTargetLanguage: SupportedLanguage;\n  translationDisplayMode: TranslationDisplayMode;\n\n  // Overlay settings\n  overlayMode: OverlayMode;\n  overlayStyle: OverlayStyle;\n  bubbleState: BubbleState;\n\n  // Shortcuts\n  toggleShortcut: string;\n  showHideShortcut: string;\n\n  // General\n  autoStart: boolean;\n  minimizeToTray: boolean;\n}\n\nexport const DEFAULT_OVERLAY_STYLE: OverlayStyle = {\n  position: 'bottom',\n  fontFamily: 'system-ui, \"Noto Sans CJK\", sans-serif',\n  fontSize: 24,\n  fontWeight: 400,\n  textColor: '#FFFFFF',\n  backgroundColor: '#000000',\n  backgroundOpacity: 0.7,\n  textShadow: true,\n  textOutline: false,\n  maxLines: 2,\n  displayDuration: 5,\n};\n\nexport const DEFAULT_BUBBLE_STATE: BubbleState = {\n  x: -1,  // -1 means center\n  y: -1,  // -1 means lower-center (75% down screen)\n  width: 320,\n  height: 80,\n  collapsed: false,\n};\n\nexport const DEFAULT_SETTINGS: AppSettings = {\n  transcriptionProvider: 'deepgram',\n  deepgramApiKey: '',\n  gladiaApiKey: '',\n  speechmaticsApiKey: '',\n  whisperModel: 'base',\n  language: 'auto',\n  gpuAcceleration: true,\n  chunkSize: 2,\n  diarization: false,\n  translationEnabled: false,\n  translationTargetLanguage: 'en',\n  translationDisplayMode: 'stacked',\n  overlayMode: 'bubble',\n  overlayStyle: DEFAULT_OVERLAY_STYLE,\n  bubbleState: DEFAULT_BUBBLE_STATE,\n  toggleShortcut: 'CommandOrControl+Shift+S',\n  showHideShortcut: 'CommandOrControl+Shift+H',\n  autoStart: false,\n  minimizeToTray: true,\n};\n\nexport const LANGUAGE_NAMES: Record<SupportedLanguage, string> = {\n  ja: 'Japanese',\n  ko: 'Korean',\n  zh: 'Chinese (Mandarin)',\n  es: 'Spanish',\n  fr: 'French',\n  de: 'German',\n  en: 'English',\n  auto: 'Auto-detect',\n};\n\nexport const PROVIDER_NAMES: Record<TranscriptionProvider, string> = {\n  deepgram: 'Deepgram',\n  gladia: 'Gladia',\n  speechmatics: 'Speechmatics',\n};\n\nexport const MODEL_INFO: Record<WhisperModel, { size: string; speed: string; accuracy: string }> = {\n  tiny: { size: '~75MB', speed: 'Fastest', accuracy: 'Good' },\n  base: { size: '~150MB', speed: 'Fast', accuracy: 'Better' },\n  small: { size: '~500MB', speed: 'Moderate', accuracy: 'Best' },\n};\n\n// IPC Channel names\nexport const IPC_CHANNELS = {\n  // Control -> Main\n  START_TRANSCRIPTION: 'start-transcription',\n  STOP_TRANSCRIPTION: 'stop-transcription',\n  GET_SETTINGS: 'get-settings',\n  UPDATE_SETTINGS: 'update-settings',\n  GET_STATE: 'get-state',\n  TRANSCRIBE_AUDIO: 'transcribe-audio',\n  GET_DESKTOP_SOURCES: 'get-desktop-sources',\n\n  // Audio capture\n  START_SYSTEM_AUDIO: 'start-system-audio',\n  STOP_SYSTEM_AUDIO: 'stop-system-audio',\n  SYSTEM_AUDIO_DATA: 'system-audio-data',\n  STREAM_AUDIO_CHUNK: 'stream-audio-chunk', // New: stream audio directly to Deepgram\n\n  // Main -> Overlay\n  TRANSCRIPTION_UPDATE: 'transcription-update',\n  CLEAR_TRANSCRIPTION: 'clear-transcription',\n  UPDATE_OVERLAY_STYLE: 'update-overlay-style',\n\n  // Overlay -> Main (bubble state)\n  SAVE_BUBBLE_STATE: 'save-bubble-state',\n  GET_BUBBLE_STATE: 'get-bubble-state',\n  TOGGLE_BUBBLE_COLLAPSE: 'toggle-bubble-collapse',\n  GET_OVERLAY_MODE: 'get-overlay-mode',\n  SET_OVERLAY_MODE: 'set-overlay-mode',\n\n  // Main -> Control\n  STATE_CHANGED: 'state-changed',\n  ERROR_OCCURRED: 'error-occurred',\n\n  // Diagnostics\n  GET_DIAGNOSTICS: 'get-diagnostics',\n\n  // Transcript history\n  GET_TRANSCRIPTS: 'get-transcripts',\n  GET_TRANSCRIPT: 'get-transcript',\n  DELETE_TRANSCRIPT: 'delete-transcript',\n  EXPORT_TRANSCRIPT: 'export-transcript',\n} as const;\n","module.exports = require(\"electron\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Check if module exists (development only)\n\tif (__webpack_modules__[moduleId] === undefined) {\n\t\tvar e = new Error(\"Cannot find module '\" + moduleId + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","/**\n * Preload script for Overlay window\n *\n * Exposes a minimal API for receiving transcription updates\n * and style changes from the main process.\n */\n\nimport { contextBridge, ipcRenderer } from 'electron';\nimport { TranscriptionResult, OverlayStyle, BubbleState, OverlayMode, AppSettings, IPC_CHANNELS } from '../shared/types';\n\n// Define the API exposed to the overlay renderer\nexport interface OverlayAPI {\n  // Event listeners\n  onTranscriptionUpdate: (callback: (result: TranscriptionResult) => void) => void;\n  onClearTranscription: (callback: () => void) => void;\n  onStyleUpdate: (callback: (style: OverlayStyle) => void) => void;\n  onOverlayModeChange: (callback: (mode: OverlayMode) => void) => void;\n\n  // Settings\n  getSettings: () => Promise<AppSettings>;\n\n  // Overlay mode\n  getOverlayMode: () => Promise<OverlayMode>;\n\n  // Bubble state\n  getBubbleState: () => Promise<BubbleState>;\n  saveBubbleState: (state: BubbleState) => Promise<BubbleState>;\n  toggleCollapse: () => Promise<BubbleState>;\n\n  // Cleanup\n  removeAllListeners: () => void;\n}\n\n// Expose protected methods to the renderer process\ncontextBridge.exposeInMainWorld('electronAPI', {\n  // Event listeners\n  onTranscriptionUpdate: (callback: (result: TranscriptionResult) => void) => {\n    ipcRenderer.on(IPC_CHANNELS.TRANSCRIPTION_UPDATE, (_event, result) => callback(result));\n  },\n\n  onClearTranscription: (callback: () => void) => {\n    ipcRenderer.on(IPC_CHANNELS.CLEAR_TRANSCRIPTION, () => callback());\n  },\n\n  onStyleUpdate: (callback: (style: OverlayStyle) => void) => {\n    ipcRenderer.on(IPC_CHANNELS.UPDATE_OVERLAY_STYLE, (_event, style) => callback(style));\n  },\n\n  onOverlayModeChange: (callback: (mode: OverlayMode) => void) => {\n    ipcRenderer.on(IPC_CHANNELS.SET_OVERLAY_MODE, (_event, mode) => callback(mode));\n  },\n\n  // Settings\n  getSettings: () => ipcRenderer.invoke(IPC_CHANNELS.GET_SETTINGS),\n\n  // Overlay mode\n  getOverlayMode: () => ipcRenderer.invoke(IPC_CHANNELS.GET_OVERLAY_MODE),\n\n  // Bubble state\n  getBubbleState: () => ipcRenderer.invoke(IPC_CHANNELS.GET_BUBBLE_STATE),\n  saveBubbleState: (state: BubbleState) => ipcRenderer.invoke(IPC_CHANNELS.SAVE_BUBBLE_STATE, state),\n  toggleCollapse: () => ipcRenderer.invoke(IPC_CHANNELS.TOGGLE_BUBBLE_COLLAPSE),\n\n  // Cleanup\n  removeAllListeners: () => {\n    ipcRenderer.removeAllListeners(IPC_CHANNELS.TRANSCRIPTION_UPDATE);\n    ipcRenderer.removeAllListeners(IPC_CHANNELS.CLEAR_TRANSCRIPTION);\n    ipcRenderer.removeAllListeners(IPC_CHANNELS.UPDATE_OVERLAY_STYLE);\n    ipcRenderer.removeAllListeners(IPC_CHANNELS.SET_OVERLAY_MODE);\n  },\n} as OverlayAPI);\n"],"names":[],"sourceRoot":""}